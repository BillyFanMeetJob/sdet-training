# 辨識策略重構說明

## 目標

將物件辨識策略從 `smart_click` 中抽離，封裝成獨立的策略方法，並提供不同優先級判定順序的方法。

## 架構設計

### 1. 策略方法（Strategy Methods）

每個辨識策略封裝成獨立的方法：

- `_try_vlm_recognition()` - VLM（視覺語言模型）辨識
- `_try_ocr_recognition()` - OCR（文字辨識）
- `_try_ok_script_recognition()` - OK Script / OpenCV 圖片辨識
- `_try_pyautogui_recognition()` - PyAutoGUI 圖片辨識
- `_try_coordinate_fallback()` - 座標保底（目前禁用）

### 2. 優先級策略方法（Priority Strategy Methods）

提供不同優先級判定順序的方法：

#### `smart_click_priority_text()`
**文字優先策略**：適合需要精確文字匹配的場景
```
優先級順序：
1. VLM（如果啟用）
2. OCR
3. OK Script 圖片辨識
4. PyAutoGUI 圖片辨識
```

#### `smart_click_priority_image()`
**圖片優先策略**：適合動態選單、圖標等場景
```
優先級順序：
1. OK Script 圖片辨識
2. PyAutoGUI 圖片辨識
3. VLM（如果啟用）
4. OCR
```

#### `smart_click()` (保持向後兼容)
**預設策略**：維持現有邏輯，內部使用新的策略方法

## 使用範例

### Page 層使用

```python
# 文字優先：點擊按鈕時，優先使用文字辨識
self.smart_click_priority_text(
    x_ratio=0.5,
    y_ratio=0.5,
    target_text="確定",
    image_path="ok_btn.png",
    timeout=3
)

# 圖片優先：點擊右鍵選單項時，優先使用圖片辨識
self.smart_click_priority_image(
    x_ratio=0.22,
    y_ratio=0.38,
    target_text="攝影機設定",
    image_path="camera_settings_menu.png",
    timeout=3
)

# 預設策略：保持原有用法
self.smart_click(
    x_ratio=0.5,
    y_ratio=0.5,
    target_text="按鈕",
    image_path="btn.png",
    timeout=3
)
```

## 實施步驟

1. ✅ 提取策略方法（`_try_vlm_recognition` 已存在）
2. ⏳ 創建其他策略方法（`_try_ocr_recognition`, `_try_ok_script_recognition`, `_try_pyautogui_recognition`）
3. ⏳ 創建優先級策略方法（`smart_click_priority_text`, `smart_click_priority_image`）
4. ⏳ 重構 `smart_click` 使用新的策略方法，保持向後兼容

## 優勢

1. **清晰的分工**：每個策略方法只負責一種辨識方式
2. **靈活的優先級**：Page 層可根據場景選擇合適的優先級策略
3. **易於維護**：修改單一策略不影響其他策略
4. **向後兼容**：保留 `smart_click`，現有代碼無需修改
