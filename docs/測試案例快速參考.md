# Nx Witness æ¸¬è©¦æ¡ˆä¾‹å¿«é€Ÿåƒè€ƒ

## ğŸ“š æ¸¬è©¦æ¡ˆä¾‹ç¸½è¦½

| æ¡ˆä¾‹ | åç¨± | ç‹€æ…‹ | èªªæ˜æ–‡ä»¶ |
|------|------|------|---------|
| Case 1-1 | ç™»å…¥èˆ‡èªç³»åˆ‡æ› | âœ… | - |
| Case 1-2 | å•Ÿç”¨ USB æ”å½±æ©Ÿè‡ªå‹•åµæ¸¬ | âœ… | [CASE_1-2_IMPLEMENTATION.md](./CASE_1-2_IMPLEMENTATION.md) |
| Case 1-3 | å•Ÿç”¨å…è²»éŒ„è£½æˆæ¬Š | âœ… | [CASE_1-3_IMPLEMENTATION.md](./CASE_1-3_IMPLEMENTATION.md) |

---

## ğŸ¯ Case 1-1: ç™»å…¥èˆ‡èªç³»åˆ‡æ›

### æ­¥é©Ÿ
1. å•Ÿå‹• Nx Witness Client
2. é»æ“Š Server Tile ç™»å…¥
3. é–‹å•Ÿä¸»é¸å–®
4. é¸æ“‡æœ¬åœ°è¨­ç½®
5. åˆ‡æ›åˆ°å¤–è§€åˆ†é 
6. ä¿®æ”¹èªç³»ç‚ºç¹é«”ä¸­æ–‡

### åŸ·è¡Œæ–¹æ³•
```python
actions.run_server_login_step()
actions.run_change_language_step(language="ç¹é«”ä¸­æ–‡")
```

### æ¸¬è©¦è…³æœ¬
```bash
# æš«ç„¡ç¨ç«‹æ¸¬è©¦è…³æœ¬
```

---

## ğŸ¯ Case 1-2: å•Ÿç”¨ USB æ”å½±æ©Ÿè‡ªå‹•åµæ¸¬

### æ­¥é©Ÿï¼ˆTestPlan æ­¥é©Ÿ 10-19ï¼‰
1. åœ¨ Server åœ–ç¤ºä¸Šå³éµ
2. é»æ“Šã€Œä¼ºæœå™¨è¨­å®šã€
3. å‹¾é¸ã€Œè‡ªå‹•åµæ¸¬å…§å»º USB æ”å½±æ©Ÿã€
4. é»æ“Šã€Œç¢ºèªã€æˆ–ã€Œå¥—ç”¨ã€
5. è™•ç†å¯†ç¢¼ç¢ºèªå½ˆçª—
6. é›™æ“Š Server åœ–ç¤ºå±•é–‹
7. é›™æ“Š USB æ”å½±æ©Ÿé–‹å•Ÿé è¦½

### åŸ·è¡Œæ–¹æ³•
```python
actions.run_enable_usb_webcam_step(camera_name="usb_cam")
```

### æ¸¬è©¦è…³æœ¬
```bash
python tests/test_case_1_2.py
```

### æ ¸å¿ƒé¡åˆ¥
- `ServerSettingsPage` - ä¼ºæœå™¨è¨­å®šé é¢
  - `right_click_server_icon()` - å³éµé»æ“Š Server
  - `click_server_settings_menu()` - é»æ“Šä¼ºæœå™¨è¨­å®šé¸å–®
  - `enable_usb_detection()` - å•Ÿç”¨ USB åµæ¸¬
  - `apply_settings()` - å¥—ç”¨è¨­å®š
  - `double_click_server_icon()` - é›™æ“Š Server
  - `double_click_usb_camera()` - é›™æ“Š USB æ”å½±æ©Ÿ

### é—œéµæŠ€è¡“
- âœ… æ™ºèƒ½ Checkbox è™•ç†ï¼ˆåœ–ç‰‡è¾¨è­˜ç‹€æ…‹ï¼‰
- âœ… å¯†ç¢¼ç¢ºèªå½ˆçª—è‡ªå‹•è™•ç†
- âœ… æ™ºèƒ½ç­‰å¾… USB æ”å½±æ©Ÿå‡ºç¾ï¼ˆæœ€å¤š 10 ç§’ï¼‰
- âœ… é›™æ“Šæ“ä½œï¼ˆ`clicks=2`, `interval=0.1`ï¼‰

---

## ğŸ¯ Case 1-3: å•Ÿç”¨å…è²»éŒ„è£½æˆæ¬Š

### æ­¥é©Ÿï¼ˆTestPlan æ­¥é©Ÿ 20-24ï¼‰
1. åœ¨ Server ä¸Šå³éµï¼Œé»é¸ã€Œç³»çµ±ç®¡ç†ã€
2. é€²å…¥ã€Œç³»çµ±ç®¡ç†ã€è¦–çª—ï¼ˆé è¨­åœ¨ã€Œä¸€èˆ¬ã€é ç±¤ï¼‰
3. åˆ‡æ›åˆ°ã€Œæˆæ¬Šã€é ç±¤
4. é»é¸ã€Œå•Ÿç”¨å…è²»æˆæ¬Šã€
5. ç¢ºèªæˆæ¬ŠæˆåŠŸå½ˆçª—
6. å›åˆ°æˆæ¬Šé ç±¤ï¼Œé¡¯ç¤ºæˆæ¬Šç¢¼
7. é—œé–‰ç³»çµ±ç®¡ç†è¦–çª—

### åŸ·è¡Œæ–¹æ³•
```python
# ä½¿ç”¨ Server å³éµï¼ˆé è¨­ï¼‰
actions.run_activate_free_license_step()

# ä½¿ç”¨å·¦ä¸Šè§’é¸å–®
actions.run_activate_free_license_step(use_menu=True)
```

### æ¸¬è©¦è…³æœ¬
```bash
python tests/test_case_1_3.py
```

### æ ¸å¿ƒé¡åˆ¥
- `LicenseSettingsPage` - æˆæ¬Šè¨­å®šé é¢
  - `open_system_administration(via_menu)` - é–‹å•Ÿç³»çµ±ç®¡ç†
  - `switch_to_license_tab()` - åˆ‡æ›åˆ°æˆæ¬Šåˆ†é 
  - `click_activate_free_license()` - é»æ“Šå•Ÿç”¨å…è²»æˆæ¬Š
  - `confirm_license_activation()` - ç¢ºèªæˆæ¬Šå•Ÿå‹•
  - `close_system_administration()` - é—œé–‰ç³»çµ±ç®¡ç†è¦–çª—

### é—œéµæŠ€è¡“
- âœ… å…©ç¨®é–‹å•Ÿæ–¹å¼ï¼ˆå³éµ / é¸å–®ï¼‰
- âœ… è¦–çª—æª¢æ¸¬èˆ‡ç­‰å¾…
- âœ… åˆ†é åˆ‡æ›
- âœ… å½ˆçª—è™•ç†
- âœ… å¤šèªè¨€æ”¯æ´

---

## ğŸ—ï¸ æ¶æ§‹è¨­è¨ˆ

### åˆ†å±¤æ¶æ§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  actions/nx_poc_actions.py      â”‚  æ¥­å‹™é‚è¼¯å±¤
â”‚  - run_*_step()                 â”‚  (ç·¨æ’æ¸¬è©¦æµç¨‹)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ èª¿ç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  pages/                         â”‚  é é¢æ“ä½œå±¤
â”‚  - ServerSettingsPage           â”‚  (å°è£é é¢æ“ä½œ)
â”‚  - LicenseSettingsPage          â”‚
â”‚  - SettingsPage                 â”‚
â”‚  - MainPage                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ èª¿ç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  base/desktop_app.py            â”‚  åŸºç¤æ“ä½œå±¤
â”‚  - smart_click()                â”‚  (é€šç”¨åŸºç¤æ–¹æ³•)
â”‚  - smart_checkbox()             â”‚
â”‚  - wait_for_window()            â”‚
â”‚  - handle_password_popup()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¨­è¨ˆåŸå‰‡
1. **åŸºç¤æ“ä½œæ–¹æ³•éƒ½åœ¨ base å±¤**
   - æ‰€æœ‰ `pyautogui` èª¿ç”¨éƒ½å°è£åœ¨ `DesktopApp`
   - Page å±¤ä¸ç›´æ¥èª¿ç”¨ `pyautogui`

2. **Page å±¤åªè² è²¬åƒæ•¸è¨­å®š**
   - å‚³å…¥åº§æ¨™ã€åœ–ç‰‡è·¯å¾‘ã€OCR æ–‡å­—
   - èª¿ç”¨ base å±¤æ–¹æ³•

3. **Actions å±¤è² è²¬æµç¨‹ç·¨æ’**
   - çµ„åˆå¤šå€‹ Page æ–¹æ³•
   - è™•ç†æ¥­å‹™é‚è¼¯
   - éŒ¯èª¤è™•ç†å’Œæ—¥èªŒè¨˜éŒ„

---

## ğŸ® åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦

### æ–¹æ³• 1: å–®ç¨åŸ·è¡Œ
```bash
# Case 1-2
python tests/test_case_1_2.py

# Case 1-3
python tests/test_case_1_3.py
```

### æ–¹æ³• 2: ä½¿ç”¨ pytest
```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
pytest tests/ -v

# åŸ·è¡Œç‰¹å®šæ¸¬è©¦
pytest tests/test_case_1_2.py -v
pytest tests/test_case_1_3.py -v
```

### æ–¹æ³• 3: ä½¿ç”¨ TestPlanï¼ˆå®Œæ•´æµç¨‹ï¼‰
```bash
# å°šæœªå¯¦ç¾ TestPlan æ•´åˆ
# å¾…å¾ŒçºŒé–‹ç™¼
```

---

## ğŸ“Š æ ¸å¿ƒæ–¹æ³•çµ±è¨ˆ

### Base å±¤æ–¹æ³•ï¼ˆDesktopAppï¼‰
| æ–¹æ³• | åŠŸèƒ½ | ä½¿ç”¨æ¡ˆä¾‹ |
|------|------|---------|
| `smart_click()` | æ™ºèƒ½é»æ“Šï¼ˆåœ–ç‰‡/OCR/åº§æ¨™ï¼‰ | 1-1, 1-2, 1-3 |
| `smart_checkbox()` | æ™ºèƒ½ Checkbox è™•ç† | 1-2 |
| `wait_for_window()` | ç­‰å¾…è¦–çª—é–‹å•Ÿ | 1-1, 1-2, 1-3 |
| `wait_for_window_close()` | ç­‰å¾…è¦–çª—é—œé–‰ | 1-2, 1-3 |
| `handle_password_popup()` | è™•ç†å¯†ç¢¼å½ˆçª— | 1-2 |
| `wait_for_screen_change()` | ç­‰å¾…ç•«é¢è®ŠåŒ– | 1-2, 1-3 |
| `type_text()` | è¼¸å…¥æ–‡å­— | 1-2 |
| `press_key()` | æŒ‰éµæ“ä½œ | 1-2 |

### Page å±¤é¡åˆ¥
| é¡åˆ¥ | åŠŸèƒ½ | æª”æ¡ˆ |
|------|------|------|
| `MainPage` | ä¸»ç•«é¢æ“ä½œ | `pages/main_page.py` |
| `SettingsPage` | æœ¬åœ°è¨­ç½®é é¢ | `pages/settings_page.py` |
| `ServerSettingsPage` | ä¼ºæœå™¨è¨­å®š | `pages/desktop/server_settings_page.py` |
| `LicenseSettingsPage` | æˆæ¬Šè¨­å®š | `pages/desktop/license_settings_page.py` |

---

## ğŸ”§ é–‹ç™¼æŒ‡å—

### æ–°å¢æ¸¬è©¦æ¡ˆä¾‹çš„æ­¥é©Ÿ

1. **å»ºç«‹ Page é¡åˆ¥**ï¼ˆå¦‚éœ€è¦ï¼‰
   ```python
   # pages/desktop/your_page.py
   from base.desktop_app import DesktopApp
   
   class YourPage(DesktopApp):
       def your_method(self):
           self.smart_click(...)  # åªèª¿ç”¨ base å±¤æ–¹æ³•
   ```

2. **åœ¨ Actions ä¸­æ–°å¢æ–¹æ³•**
   ```python
   # actions/nx_poc_actions.py
   def run_your_step(self, **kwargs):
       self.your_page.your_method()
   ```

3. **å»ºç«‹æ¸¬è©¦è…³æœ¬**
   ```python
   # tests/test_your_case.py
   actions = NxPocActions(None)
   actions.run_ensure_login_step()
   actions.run_your_step()
   ```

4. **æ’°å¯«èªªæ˜æ–‡ä»¶**
   ```markdown
   # docs/CASE_X-Y_IMPLEMENTATION.md
   åƒè€ƒ CASE_1-3_IMPLEMENTATION.md æ ¼å¼
   ```

---

## ğŸ¨ åœ–ç‰‡è³‡æºç®¡ç†

### ç›®éŒ„çµæ§‹
```
res/
â”œâ”€â”€ common/              # é€šç”¨åœ–ç‰‡
â”œâ”€â”€ desktop_login/       # ç™»å…¥ç›¸é—œ
â”œâ”€â”€ desktop_main/        # ä¸»ç•«é¢ç›¸é—œ
â”‚   â”œâ”€â”€ menu_icon.png
â”‚   â”œâ”€â”€ server_icon.png
â”‚   â””â”€â”€ local_settings.png
â””â”€â”€ desktop_settings/    # è¨­å®šç›¸é—œ
    â”œâ”€â”€ usb_checkbox.png
    â”œâ”€â”€ checkbox_checked.png
    â”œâ”€â”€ checkbox_unchecked.png
    â”œâ”€â”€ ok_btn.png
    â””â”€â”€ apply_btn.png
```

### åœ–ç‰‡æˆªå–å»ºè­°
- **å°ºå¯¸**: ç›¡é‡å°ä½†æ¸…æ™°ï¼ˆå¦‚ 50x40, 80x30ï¼‰
- **æ ¼å¼**: PNGï¼ˆæ”¯æ´é€æ˜åº¦ï¼‰
- **å‘½å**: ä½¿ç”¨æè¿°æ€§åç¨±ï¼ˆå¦‚ `server_icon.png`ï¼‰
- **ä½ç½®**: æŒ‰åŠŸèƒ½æ¨¡çµ„åˆ†é¡å­˜æ”¾

---

## ğŸ“ æ—¥èªŒç®¡ç†

### æ—¥èªŒç­‰ç´š
- `INFO` - æ­£å¸¸æµç¨‹ï¼ˆå¦‚ï¼šâœ… æˆåŠŸé»æ“ŠæŒ‰éˆ•ï¼‰
- `WARNING` - å¯æ¢å¾©éŒ¯èª¤ï¼ˆå¦‚ï¼šâš ï¸ æœªæª¢æ¸¬åˆ°è¦–çª—ï¼‰
- `ERROR` - åš´é‡éŒ¯èª¤ï¼ˆå¦‚ï¼šâŒ æ“ä½œå¤±æ•—ï¼‰
- `DEBUG` - é™¤éŒ¯è³‡è¨Šï¼ˆå¦‚ï¼šğŸ” å˜—è©¦å®šä½å…ƒç´ ï¼‰

### æ—¥èªŒè¼¸å‡º
```
logs/
â”œâ”€â”€ automation.log       # ä¸»æ—¥èªŒ
â”œâ”€â”€ detail_YYYYMMDD.log  # æ¯æ—¥è©³ç´°æ—¥èªŒ
â””â”€â”€ test_run.log         # æ¸¬è©¦åŸ·è¡Œæ—¥èªŒ
```

---

## ğŸš€ å¾ŒçºŒè¦åŠƒ

### å¾…é–‹ç™¼åŠŸèƒ½
- [ ] Case 1-4 ~ 1-Nï¼ˆå…¶ä»–æ¸¬è©¦æ¡ˆä¾‹ï¼‰
- [ ] TestPlan è‡ªå‹•åŒ–æ•´åˆ
- [ ] å¤šèªè¨€ UI è‡ªå‹•é©é…
- [ ] åœ–ç‰‡è³‡æºè‡ªå‹•æ›´æ–°å·¥å…·
- [ ] æ¸¬è©¦å ±å‘Šç”Ÿæˆ

### å„ªåŒ–æ–¹å‘
- [ ] æå‡åœ–ç‰‡è¾¨è­˜æº–ç¢ºç‡
- [ ] æ¸›å°‘ç­‰å¾…æ™‚é–“ï¼ˆæ™ºèƒ½ç­‰å¾…ï¼‰
- [ ] å¢åŠ é‡è©¦æ©Ÿåˆ¶
- [ ] æ”¯æ´ä¸¦è¡Œæ¸¬è©¦

---

**ç‰ˆæœ¬ï¼š** 1.0  
**æ›´æ–°æ—¥æœŸï¼š** 2026-01-16  
**ç¶­è­·è€…ï¼š** Cursor AI Assistant
