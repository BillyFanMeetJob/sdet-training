# 測試案例啟動器使用說明

## 概述

測試案例啟動器 (Test Case Launcher) 是一個圖形化工具，用於快速選擇和執行測試案例，並即時查看執行結果。

## 功能特色

- ✅ **動態載入**：自動從 `DemoData/TestPlan.xlsx` 讀取測試案例清單
- ✅ **圖形介面**：直觀的 tkinter GUI，支援複選框勾選
- ✅ **多線程執行**：測試執行時保持 UI 響應，不會凍結介面
- ✅ **即時結果**：執行後立即在列表中顯示 Pass/Fail 狀態
- ✅ **執行日誌**：詳細的執行日誌記錄，包含時間戳和級別

## 快速開始

### 1. 啟動應用程式

```bash
python test_case_launcher.py
```

### 2. 使用介面

#### 標題區域
顯示 "自動化測試啟動器"

#### 控制按鈕
- **全選**：勾選所有測試案例
- **全不選**：取消所有勾選，並清除狀態顯示

#### 測試案例清單
- 每個測試案例前有複選框，可以勾選要執行的案例
- 執行後會在右側顯示狀態：
  - ✓ **Pass**（綠色）：測試通過
  - ✗ **Fail**（紅色）：測試失敗
  - ⏳ **Running...**（藍色）：測試執行中

#### 執行控制
- **▶ Run**：開始執行所有勾選的測試案例
- **⏹ Stop**：停止當前執行

#### 執行日誌
顯示詳細的執行過程和結果

## 執行模式

### 模擬模式（預設）

在 `execute_test_logic()` 函數中，預設使用模擬模式：

```python
USE_MOCK_MODE = True  # 模擬模式
```

- **優點**：快速執行，不需要實際運行測試，適合 UI 測試和演示
- **行為**：隨機產生 Pass/Fail 結果（90% 通過率），執行時間 1-3 秒

### 真實模式

如需執行真實的 pytest 測試，修改代碼：

```python
USE_MOCK_MODE = False  # 真實模式
```

- **優點**：實際執行測試邏輯，獲得真實的測試結果
- **行為**：調用 `pytest tests/test_runner.py --test_name=<test_name>`
- **要求**：需要正確配置測試環境和依賴

## 錯誤處理

啟動器會處理以下異常情況：

1. **檔案不存在**：顯示錯誤對話框，清單為空
2. **權限錯誤**：提示檔案可能正在被其他程式使用
3. **欄位缺失**：檢查 `TestName` 欄位是否存在
4. **無測試案例**：提示未找到任何測試案例

## 技術架構

- **UI 框架**：tkinter（Python 標準庫）
- **資料處理**：pandas（讀取 Excel）
- **多線程**：threading（保持 UI 響應）
- **資料來源**：`DemoData/TestPlan.xlsx` → `TestDir` 工作表 → `TestName` 欄位

## 自訂配置

### 修改測試計劃路徑

如需使用不同的 Excel 檔案，修改 `config.py`：

```python
TEST_PLAN_PATH = os.path.join(PROJECT_ROOT, "DemoData", "TestPlan.xlsx")
```

### 調整 UI 大小

修改 `build_ui()` 中的視窗尺寸：

```python
self.root.geometry("800x700")  # 寬度 x 高度
```

### 自訂日誌格式

修改 `log()` 函數中的日誌格式：

```python
log_entry = f"[{timestamp}] [{level}] {message}\n"
```

## 注意事項

1. **Excel 檔案**：確保 `TestPlan.xlsx` 存在且未被其他程式鎖定
2. **執行環境**：真實模式需要正確的 pytest 環境配置
3. **多線程安全**：UI 更新使用 `root.after()` 確保線程安全
4. **停止執行**：點擊 Stop 後最多等待 2 秒讓執行線程結束

## 擴展建議

1. **匯出結果**：可添加「匯出結果」功能，將執行結果保存為 CSV 或 JSON
2. **歷史記錄**：記錄歷史執行結果，支援對比分析
3. **並行執行**：支援多個測試案例並行執行（需要更複雜的線程管理）
4. **測試報告**：整合 pytest-html 生成 HTML 測試報告
5. **配置管理**：添加設定對話框，可配置執行模式、超時時間等
